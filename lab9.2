#include <stdio.h>
#include <locale.h>



struct byer {
    char name[10];
    char lastname[15];
    char surname[15];
    char adress[20];
    char phone[14];
    long int name_card;
};

struct byer data[10];

void surch (a)
{
    int card, j, ff = 0, i = 0;
     for (i = 0; i < a; i++)
     {
         printf("Введите номер карты для поиска ее в базе\n");
         scanf("%d", &card);
         for (j = 0; j < a; j++)
         {
             if (data[j].name_card == card)
             {
                 ff = 1;
             }
             // else if (ff != 1) printf("В базе такой карты нет\n");
         
             if (ff == 1)
             {
                 printf("Карта найдена!\n");
                 printf("Имя: %s\n", data[j].name);
                 printf("Фамилия: %s\n", data[j].lastname);
                 printf("Отчество: %s\n", data[j].surname);
                 printf("Адрес: %s\n", data[j].adress);
                 printf("Телефон: %s\n", data[j].phone);
                 printf("--------------------");
                 j = a;
                 i = a;
             }
             else printf("В базе такой карты нет\n");
         }
     }
}

void vivod (int a)
{
    int i;
    char str[40];
    FILE *n;
    n = fopen("byer.txt", "a+b");
    //fseek(n, 0, 0);
    printf("Пользовательская БЗ\n");
    printf("|||||||||||||||||||\n");
    for (i = 0; i < a; i++)
    {
        //fseek(n, i, 0);
        fscanf(n, "%s", str);
        printf("%s", str);
        
        /*
         printf("\nФорма покупателя номер [%d] \n", i + 1);
        printf("ФИО: %s %s %s\n", data[i].lastname, data[i].name, data[i].surname);
        printf("Адрес: %s\n", data[i].adress);
        printf("Телефон: %s\n", data[i].phone);
        printf("Номер карты: %d\n", data[i].name_card);
        printf("------------------\n");
         */
    }
}


void vvv (FILE*t, int a)
{
    int i;
    for (i = 0; i < a; i++)
        //t = fopen("byer.txt", "a");
    {
        printf("Введите имя покупателя номер [%d]\n", i + 1);
        scanf("%s", data[i].name);
        printf("Введите фамилию покупателя номер [%d]\n", i + 1);
        scanf("%s", data[i].lastname);
        printf("Введите отчество покупателя номер [%d]\n", i + 1);
        //gets(data[i].surname);
        scanf("%s", data[i].surname);
        printf("Введите домашний адресс покупателя номер [%d] (Вводите без пробелов)\n", i + 1);
        getchar();
        gets(data[i].adress);//scanf("%s", &data[i].adress);
        printf("Введите номер телефона покупателя номер [%d] (Пример: +375291234567)\n", i + 1);
        getchar();
        scanf("%s", data[i].phone);
        printf("Введите номер карты покупателя номер [%d] (Пример: 1234432112344321)\n", i + 1);
        getchar();
        scanf("%d", &data[i].name_card);
        fprintf(t, "%s %s %s %s %s %d ", data[i].name, data[i].lastname, data[i].surname, data[i].adress, data[i].phone, data[i].name_card);
    }
    fclose(t);
}

void google (struct byer* data1, int a)
{
    int card, j, f = 0, i;
    for (i = 0; i < a; i++)
    {
        printf("Введите номер карты для поиска ее в базе\n");
        scanf("%d", &card);
        for (j = 0; j < a; j++)
        {
            if (data1[j].name_card == card)
            {
                f = 1;
            }
            else printf("В базе такой карты нет\n");
        
            if (f == 1)
            {
                printf("Карта найдена!\n");
                printf("Имя: %s\n", data1[j].name);
                printf("Фамилия: %s\n", data1[j].lastname);
                printf("Отчество: %s\n", data1[j].surname);
                printf("Адрес: %s\n", data1[j].adress);
                printf("Телефон: %s\n", data1[j].phone);
                j = a;
                
            }
        }
    }
}

int main()
{
    setlocale(LC_ALL, "rus");
    struct byer {
        char name[10];
        char lastname[15];
        char surname[15];
        char adress[20];
        char phone[14];
        int name_card;
    };
    //struct byer data[10];
    FILE *f;
    int a, i;
    int card = 0, j, ff = 0;
    int c=8;
    f = fopen("byer.txt", "a");
    printf("Введите количество покупателей\n");
    scanf("%d", &a);
    //struct byer data[a];
   // printf("Выберете опцию:\n1 - Прописать данные в БЗ\n2 - Выполнить поиск по номеру карты\n3 - Вывести данные из БЗ\n4 - загрузить в файл всю базу данных\n0 - Выход\n");
    //scanf("%d", &c);
    while (c != 0)
    {
        printf("Выберете опцию:\n1 - Прописать данные в БЗ\n2 - Выполнить поиск по номеру карты\n3 - Вывести данные из БЗ\n4 - загрузить в файл всю базу данных\n0 - Выход\n");
        scanf("%d", &c);
    switch (c)
    {
        case 1:
            vvv(f, a);
            //printf("Введите количество покупателей\n");
            //scanf("%d", &a);
            //struct byer data[a];
          /*  for (i = 0; i < a; i++)
            {
                printf("Введите имя покупателя номер [%d]\n", i + 1);
                scanf("%s", data[i].name);
                printf("Введите фамилию покупателя номер [%d]\n", i + 1);
                scanf("%s", data[i].lastname);
                printf("Введите отчество покупателя номер [%d]\n", i + 1);
                //gets(data[i].surname);
                scanf("%s", data[i].surname);
                printf("Введите домашний адресс покупателя номер [%d] (Вводите без пробелов)\n", i + 1);
                getchar();
                gets(data[i].adress);//scanf("%s", &data[i].adress);
                printf("Введите номер телефона покупателя номер [%d] (Пример: +375291234567)\n", i + 1);
                getchar();
                scanf("%s", data[i].phone);
                printf("Введите номер карты покупателя номер [%d] (Пример: 1234432112344321)\n", i + 1);
                getchar();
                scanf("%d", data[i].name_card);
            }
            */
            break;
        case 2:
            surch(a);
            //int card, j, ff = 0;
             for (i = 0; i < a; i++)
             {
                 printf("Введите номер карты для поиска ее в базе\n");
                 scanf("%d", &card);
                 for (j = 0; j < a; j++)
                 {
                     if (data[j].name_card == card)
                     {
                         ff = 1;
                     }
                     // else if (ff != 1) printf("В базе такой карты нет\n");
                 
                     if (ff == 1)
                     {
                         printf("Карта найдена!\n");
                         printf("Имя: %s\n", data[j].name);
                         printf("Фамилия: %s\n", data[j].lastname);
                         printf("Отчество: %s\n", data[j].surname);
                         printf("Адрес: %s\n", data[j].adress);
                         printf("Телефон: %s\n", data[j].phone);
                         j = a;
                         i = a;
                     }
                     else printf("В базе такой карты нет\n");
                 }
             }
            
            break;
        case 3:
            vivod(a);
                /*for (i = 0; i < a; i++)
                {
                    printf("\nФорма покупателя номер [%d] \n", i + 1);
                    printf("ФИО: %s %s %s\n", data[i].lastname, data[i].name, data[i].surname);
                    printf("Адрес: %s\n", data[i].adress);
                    printf("Телефон: %s\n", data[i].phone);
                    printf("Номер карты: %d\n", data[i].name_card);
                    printf("------------------\n");
                }
                 */
            break;
        case 4:
            f = fopen("byer.txt", "a");
            if (!(f = fopen("byer.txt", "a")))
                printf("File could not be opened\n");
            else
            {
                for (i = 0; i < a; i++)
                    fprintf(f, " %s %s %s : %s : %s : %d\n", data[i].name, data[i].lastname, data[i].surname, data[i].adress, data[i].phone, data[i].name_card);
                printf("Данные добалены успешно!\n");
            }
            break;

    }
    }
    /*
     f = fopen("byer.txt", "a");
    if (!(f = fopen("byer.txt", "w")))
        printf("File could not be opened\n");
    else
    {
        printf("Введите количество покупателей\n");
        scanf("%d", &a);
        struct byer data[a];
        for (i = 0; i < a; i++)
        {
            printf("Введите имя покупателя номер [%d]\n", i + 1);
            scanf("%s", &data[i].name);
            printf("Введите фамилию покупателя номер [%d]\n", i + 1);
            scanf("%s", &data[i].lastname);
            printf("Введите отчество покупателя номер [%d]\n", i + 1);
            //gets(data[i].surname);
            scanf("%s", &data[i].surname);
            printf("Введите домашний адресс покупателя номер [%d] (Вводите без пробелов)\n", i + 1);
            getchar();
            gets(data[i].adress);//scanf("%s", &data[i].adress);
            printf("Введите номер телефона покупателя номер [%d] (Пример: +375291234567)\n", i + 1);
            getchar();
            scanf("%s", &data[i].phone);
            printf("Введите номер карты покупателя номер [%d] (Пример: 1234432112344321)\n", i + 1);
            getchar();
            scanf("%d", &data[i].name_card);

            
            
            fprintf(f, " %s %s %s : %s : %s : %d\n", data[i].name, data[i].lastname, data[i].surname, data[i].adress, data[i].phone, data[i].name_card);
            
            
        }
     
        */
    
        //ПОИСК ПО КАРТЕ ПОКУПАТЕЛЯ

       /* int card, j, f = 0;
        for (i = 0; i < a; i++)
        {
            printf("Введите номер карты для поиска ее в базе\n");
            scanf("%d", &card);
            for (j = 0; j < a; j++)
            {
                if (data[j].name_card == card)
                {
                    f = 1;
                }
                else printf("В базе такой карты нет\n");
            
                if (f == 1)
                {
                    printf("Карта найдена!\n");
                    printf("Имя: %s\n", data[j].name);
                    printf("Фамилия: %s\n", data[j].lastname);
                    printf("Отчество: %s\n", data[j].surname);
                    printf("Адрес: %s\n", data[j].adress);
                    printf("Телефон: %s\n", data[j].phone);
                    j = a;
                    i = a;
                }
            }
        }
        */
        
        //ВВЫВОД НА ЭКРАН СТРУКТУРУ ПОКУПАТЕЛЕЙ
        
        /*
        for (i = 0; i < a; i++)
        {
            printf("\nФорма покупателя номер [%d] \n", i + 1);
            printf("ФИО: %s %s %s\n", data[i].lastname, data[i].name, data[i].surname);
            printf("Адрес: %s\n", data[i].adress);
            printf("Телефон: %s\n", data[i].phone);
            printf("Номер карты: %d\n", data[i].name_card);
            printf("------------------\n");
        }
        
        
        */
        
        printf("Программа завершина успешно\n");
    
    
    return 0;
}
